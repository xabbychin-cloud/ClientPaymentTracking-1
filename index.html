<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Client Payment Tracker</title>

<style>
body { margin:0; font-family: Arial; background:#f4f4f4 }
h1 { background:#2e7d32; color:white; padding:15px; text-align:center }

.section { background:white; margin:20px; padding:20px; border-radius:6px }
input, button { width:100%; padding:10px; margin-top:10px }
button { cursor:pointer; background:#4CAF50; color:white; border:none }
button:hover { background:#43a047 }
#logoutBtn { background:#c62828 }
.hidden { display:none }
</style>
</head>

<body>

<h1>Client Payment Tracker</h1>

<!-- AUTH -->
<div id="authSection" class="section">
  <h3>Login / Sign Up</h3>
  <input id="loginEmail" placeholder="Email">
  <input id="loginPassword" type="password" placeholder="Password">
  <button id="loginBtn">Login</button>
  <button id="signupBtn">Sign Up</button>
</div>

<!-- APP -->
<div id="appSection" class="section hidden">
  <h3>Welcome</h3>
  <p id="userEmail"></p>
  <button id="logoutBtn">Logout</button>
</div>

<script type="module">
/* =========================
   FIREBASE IMPORTS
========================= */
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import {
  getAuth,
  signInWithEmailAndPassword,
  createUserWithEmailAndPassword,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
import {
  getFirestore,
  doc,
  setDoc
} from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

/* =========================
   FIREBASE CONFIG
========================= */
const firebaseConfig = {
  apiKey: "AIzaSyCrtGcFZVwP6dlsc_Bljr_yN-nu6hxihVg",
  authDomain: "client-payment-tracker-3572b.firebaseapp.com",
  projectId: "client-payment-tracker-3572b",
  storageBucket: "client-payment-tracker-3572b.appspot.com",
  messagingSenderId: "REPLACE_WITH_YOUR_ID",
  appId: "REPLACE_WITH_YOUR_APP_ID"
};

/* =========================
   INIT
========================= */
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* =========================
   DOM ELEMENTS
========================= */
const authSection = document.getElementById("authSection");
const appSection = document.getElementById("appSection");
const loginEmail = document.getElementById("loginEmail");
const loginPassword = document.getElementById("loginPassword");
const loginBtn = document.getElementById("loginBtn");
const signupBtn = document.getElementById("signupBtn");
const logoutBtn = document.getElementById("logoutBtn");
const userEmail = document.getElementById("userEmail");

/* =========================
   LOGIN
========================= */
loginBtn.onclick = async () => {
  try {
    await signInWithEmailAndPassword(
      auth,
      loginEmail.value.trim(),
      loginPassword.value.trim()
    );
  } catch (e) {
    alert(e.message);
  }
};

/* =========================
   SIGN UP
========================= */
signupBtn.onclick = async () => {
  if (loginPassword.value.length < 6) {
    alert("Password must be at least 6 characters");
    return;
  }

  try {
    const cred = await createUserWithEmailAndPassword(
      auth,
      loginEmail.value.trim(),
      loginPassword.value.trim()
    );

    await setDoc(doc(db, "users", cred.user.uid), {
      email: cred.user.email,
      createdAt: new Date()
    });

    alert("Account created & logged in");
  } catch (e) {
    alert(e.message);
  }
};

/* =========================
   AUTH STATE
========================= */
onAuthStateChanged(auth, user => {
  if (user) {
    authSection.classList.add("hidden");
    appSection.classList.remove("hidden");
    userEmail.textContent = "Logged in as: " + user.email;
  } else {
    authSection.classList.remove("hidden");
    appSection.classList.add("hidden");
  }
});

/* =========================
   LOGOUT
========================= */
logoutBtn.onclick = async () => {
  await signOut(auth);
};
</script>

</body>
</html>
